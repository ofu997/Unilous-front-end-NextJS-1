{"ast":null,"code":"var _jsxFileName = \"C:\\\\Code\\\\Projects\\\\projectU\\\\projectu\\\\pages\\\\results\\\\[searchQuery].js\",\n    _s = $RefreshSig$();\n\nvar __jsx = React.createElement;\nimport React, { useState, useEffect } from 'react';\nimport { connect } from 'react-redux';\nimport resStyle from '../../styles/pages/results.module.css';\nimport Post from '../../components/post/Post';\nimport { useQuery } from '@apollo/react-hooks';\nimport { SEARCH_POSTS } from '../../src/schemas/queries';\nimport { addPosts } from '../../redux/reducers/posts';\nimport Link from 'next/link';\nimport Loading from '../../components/Loading';\nimport { palletteGenerator } from '../../src/functions/functions';\nimport { toggleStretchLayout } from '../../redux/reducers/stretchLayout';\nimport { setEventSearch } from '../../redux/reducers/eventSearch';\nimport { bindActionCreators } from 'redux';\nimport { withRouter } from 'next/router';\nimport { apolloClient } from '../../lib/apollo';\nimport Layout from '../../components/Layout';\nimport Head from 'next/head';\nconst Results = withRouter(_c = _s(props => {\n  _s();\n\n  console.log(props);\n  const currentIds = props.posts ? props.posts.map(p => p._id) : [];\n  const {\n    0: scrollAtBottom,\n    1: setScrollAtBottom\n  } = useState(false);\n  const decodedSearch = decodeURIComponent(props.router.query.searchQuery) === 'all' ? '' : decodeURIComponent(props.router.query.searchQuery);\n  const SPQuery = useQuery(SEARCH_POSTS, {\n    variables: {\n      filterString: decodedSearch,\n      postIds: currentIds,\n      eventQuery: props.eventSearch\n    }\n  });\n\n  const moreResults = () => {\n    if (SPQuery.data && SPQuery.data.searchPosts === null) {\n      return false;\n    }\n\n    return true;\n  };\n\n  if (true) {\n    if (window.innerHeight + window.scrollY > document.body.offsetHeight - 100 && !scrollAtBottom) {\n      setScrollAtBottom(true);\n    }\n\n    if (window.innerHeight + window.scrollY <= document.body.offsetHeight - 100 && scrollAtBottom) {\n      setScrollAtBottom(false);\n    }\n\n    const triggerWhenScroll = () => {\n      if (window.innerHeight + window.scrollY > document.body.offsetHeight - 100 && !scrollAtBottom) {\n        setScrollAtBottom(true);\n      }\n\n      if (window.innerHeight + window.scrollY <= document.body.offsetHeight - 100 && scrollAtBottom) {\n        setScrollAtBottom(false);\n      }\n    };\n\n    window.addEventListener('scroll', triggerWhenScroll, false);\n  }\n\n  const postChangeConditions = (query, reducer) => {\n    if (!scrollAtBottom) return false;\n    if (!query) return false;\n    if (!query.searchPosts) return false;\n\n    if (!reducer) {\n      return true;\n    }\n\n    const queryTitles = query.searchPosts.map(i => i.title);\n    const reducerTitles = reducer.map(i => i.title);\n\n    for (const title of queryTitles) {\n      if (!reducerTitles.includes(title)) {\n        return true;\n      }\n    }\n\n    return false;\n  };\n\n  const postsSearched = postChangeConditions(SPQuery.data, props.posts) ? SPQuery.data.searchPosts : null;\n  useEffect(() => {\n    if (props.initialPosts.length && !props.posts) {\n      props.addPosts(props.initialPosts);\n    }\n\n    if (postsSearched && !props.posts) {\n      props.addPosts(SPQuery.data.searchPosts);\n      setScrollAtBottom(false);\n    }\n\n    if (postsSearched && props.posts) {\n      if (postsSearched.length > 0) {\n        if (!props.posts.map(p => p._id).includes(postsSearched[0]._id)) {\n          props.addPosts(SPQuery.data.searchPosts);\n          setScrollAtBottom(false);\n        }\n      }\n    }\n  }, [SPQuery, props.addPosts, props, postsSearched]); // if (!props.posts) {\n  //     return (\n  //         <div>\n  //             <div style={{height: '5vh'}}/>\n  //             <Loading />\n  //         </div>\n  //     )\n  // }\n\n  const eventQuery = props.eventSearch;\n\n  const eventKeys = () => {\n    if (eventQuery === 'COVID-19') {\n      return ['covid', 'coronavirus', 'outbreak', 'virus', 'emergency response'];\n    }\n\n    if (eventQuery === '2020 Election') {\n      return ['election', 'democrat', 'republican', 'vote'];\n    }\n\n    return null;\n  };\n\n  const postToShow = post => {\n    if (eventKeys()) {\n      for (const keyWord of eventKeys()) {\n        if (post.description.toLowerCase().includes(keyWord) || post.title.toLowerCase().includes(keyWord)) {\n          if (post.title.toLowerCase().includes(decodedSearch.toLowerCase())) return true;\n        }\n      }\n\n      return false;\n    }\n\n    if (post.title.toLowerCase().includes(decodedSearch.toLowerCase())) return true;\n\n    for (const skill of post.skillNames) {\n      if (decodedSearch.includes(skill)) return true;\n    }\n\n    return false;\n  };\n\n  const postsArray = props.posts ? props.posts.filter(p => postToShow(p)) : [];\n  const postsToShow = postsArray ? postsArray.map(p => __jsx(Post, {\n    stretch: props.stretchLayout,\n    key: `post${p._id}`,\n    post: p,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 124,\n      columnNumber: 59\n    }\n  })) : [];\n  const pallette = palletteGenerator('rgb(40,40,40)').colorPallette;\n  const layoutBtnClass = props.stretchLayout ? resStyle.layoutButtonGrid : resStyle.layoutButtonStretch;\n  const layoutClass = !props.stretchLayout ? resStyle.resultsContentGrid : resStyle.resultsContentStretch;\n  const eventsList = [{\n    name: 'COVID-19',\n    color: 'rgb(237,32,40)',\n    iconB: '/svg/events/virusB.svg',\n    iconW: '/svg/events/virusW.svg',\n    iconC: '/svg/events/virusC.svg'\n  }, {\n    name: '2020 Election',\n    color: 'rgb(255,0,255)',\n    iconB: '/svg/events/usaB.svg',\n    iconW: '/svg/events/usaW.svg',\n    iconC: '/svg/events/usaC.svg'\n  }];\n  const eventsHTML = eventsList.map(e => e.name === props.eventSearch ? __jsx(\"div\", {\n    className: resStyle.eventSelected,\n    onClick: () => props.setEventSearch(null),\n    style: {\n      borderColor: e.color,\n      backgroundColor: e.color\n    },\n    key: `EV${e.name}`,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 134,\n      columnNumber: 9\n    }\n  }, __jsx(\"img\", {\n    src: e.iconW,\n    className: resStyle.eventImage,\n    alt: e.name,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 135,\n      columnNumber: 13\n    }\n  }), __jsx(\"h3\", {\n    className: resStyle.eventText,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 136,\n      columnNumber: 13\n    }\n  }, e.name)) : __jsx(\"div\", {\n    className: resStyle.event,\n    onClick: () => props.setEventSearch(e.name),\n    style: {\n      borderColor: e.color,\n      color: e.color\n    },\n    key: `EV${e.name}`,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 139,\n      columnNumber: 9\n    }\n  }, __jsx(\"img\", {\n    src: e.iconC,\n    className: resStyle.eventImage,\n    alt: e.name,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 140,\n      columnNumber: 13\n    }\n  }), __jsx(\"h3\", {\n    className: resStyle.eventText,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 141,\n      columnNumber: 13\n    }\n  }, e.name)));\n  const eventsContainerClass = props.eventSearch ? resStyle.ECActive : null;\n  const showLoading = moreResults() ? __jsx(Loading, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 145,\n      columnNumber: 41\n    }\n  }) : __jsx(\"h3\", {\n    style: {\n      opacity: '0.8'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 145,\n      columnNumber: 55\n    }\n  }, \"no more posts\");\n  const titlesString = postsArray.map(p => p.title).join(', ');\n  return __jsx(Layout, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 148,\n      columnNumber: 9\n    }\n  }, __jsx(Head, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 149,\n      columnNumber: 13\n    }\n  }, __jsx(\"title\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 150,\n      columnNumber: 17\n    }\n  }, \"Browse for projects in Unilous\"), __jsx(\"meta\", {\n    property: \"og:title\",\n    content: \"Browse for projects in Unilous\",\n    key: \"title\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 151,\n      columnNumber: 17\n    }\n  }), __jsx(\"meta\", {\n    property: \"og:description\",\n    content: `Unilous projects: ${titlesString}.`,\n    key: \"description\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 152,\n      columnNumber: 17\n    }\n  }), __jsx(\"meta\", {\n    name: \"twitter:title\",\n    content: \"Browse for projects in Unilous\",\n    key: \"title\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 153,\n      columnNumber: 17\n    }\n  }), __jsx(\"meta\", {\n    name: \"description\",\n    content: `Unilous projects: ${titlesString}.`,\n    key: \"description\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 154,\n      columnNumber: 17\n    }\n  })), __jsx(\"div\", {\n    className: \"home-wrapper\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 156,\n      columnNumber: 13\n    }\n  }, __jsx(\"div\", {\n    className: resStyle.resultsContainer,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 157,\n      columnNumber: 17\n    }\n  }, __jsx(Link, {\n    href: \"/PostFormPage\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 158,\n      columnNumber: 21\n    }\n  }, __jsx(\"a\", {\n    className: `${resStyle.formContainerExpand} standard-hover neutralize-link`,\n    title: \"add post\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 159,\n      columnNumber: 25\n    }\n  }, __jsx(\"img\", {\n    className: resStyle.formExpandIcon,\n    src: \"/svg/plusW.svg\",\n    alt: \"team up\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 160,\n      columnNumber: 29\n    }\n  }))), __jsx(\"div\", {\n    className: \"navbar-height\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 163,\n      columnNumber: 21\n    }\n  }), __jsx(\"h2\", {\n    className: resStyle.secondaryTitle,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 164,\n      columnNumber: 21\n    }\n  }, \"events\"), __jsx(\"div\", {\n    className: `${resStyle.eventsContainer} ${eventsContainerClass}`,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 165,\n      columnNumber: 21\n    }\n  }, eventsHTML), __jsx(\"div\", {\n    onClick: () => props.toggleStretchLayout(!props.stretchLayout),\n    className: resStyle.layoutWrapper,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 168,\n      columnNumber: 21\n    }\n  }, __jsx(\"div\", {\n    className: resStyle.layoutContainer,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 169,\n      columnNumber: 25\n    }\n  }, __jsx(\"div\", {\n    className: `layoutButton ${layoutBtnClass}`,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 170,\n      columnNumber: 29\n    }\n  }, __jsx(\"div\", {\n    className: resStyle.layoutBox,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 171,\n      columnNumber: 33\n    }\n  }), __jsx(\"div\", {\n    className: resStyle.layoutBox,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 172,\n      columnNumber: 33\n    }\n  }), __jsx(\"div\", {\n    className: resStyle.layoutBox,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 173,\n      columnNumber: 33\n    }\n  }), __jsx(\"div\", {\n    className: resStyle.layoutBox,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 174,\n      columnNumber: 33\n    }\n  })))), __jsx(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 178,\n      columnNumber: 21\n    }\n  }), __jsx(\"div\", {\n    className: `resultsContent ${layoutClass}`,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 179,\n      columnNumber: 21\n    }\n  }, postsToShow), __jsx(\"div\", {\n    style: {\n      position: 'relative',\n      height: '400px'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 183,\n      columnNumber: 21\n    }\n  }, showLoading))));\n}, \"Tr6hAAZ4lOTstbTpwAADi3sQdGQ=\", false, function () {\n  return [useQuery];\n})); // const mapStateToProps = (state) => {\n// \treturn {\n//         posts: state.posts,\n//         search: state.search,\n//         stretchLayout: state.stretchLayout,\n//         eventSearch: state.eventSearch,\n// \t}\n// }\n// export default connect(\n//     mapStateToProps,\n//     { addPosts, toggleStretchLayout, setEventSearch }\n// )(Results)\n\n_c2 = Results;\n\nResults.getInitialProps = async context => {\n  const decodedSearch = decodeURIComponent(context.query.searchQuery) === 'all' ? '' : decodeURIComponent(context.query.searchQuery);\n  const postsQuery = await apolloClient.query({\n    query: SEARCH_POSTS,\n    variables: {\n      filterString: decodedSearch,\n      postIds: [],\n      eventQuery: null\n    }\n  }).catch(err => console.log(err));\n  return {\n    initialPosts: postsQuery.data.searchPosts\n  };\n};\n\nconst mapStateToProps = state => {\n  return {\n    posts: state.posts,\n    stretchLayout: state.stretchLayout,\n    eventSearch: state.eventSearch\n  };\n};\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    addPosts: bindActionCreators(addPosts, dispatch),\n    toggleStretchLayout: bindActionCreators(toggleStretchLayout, dispatch),\n    setEventSearch: bindActionCreators(setEventSearch, dispatch)\n  };\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Results);\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"Results$withRouter\");\n$RefreshReg$(_c2, \"Results\");","map":{"version":3,"sources":["C:/Code/Projects/projectU/projectu/pages/results/[searchQuery].js"],"names":["React","useState","useEffect","connect","resStyle","Post","useQuery","SEARCH_POSTS","addPosts","Link","Loading","palletteGenerator","toggleStretchLayout","setEventSearch","bindActionCreators","withRouter","apolloClient","Layout","Head","Results","props","console","log","currentIds","posts","map","p","_id","scrollAtBottom","setScrollAtBottom","decodedSearch","decodeURIComponent","router","query","searchQuery","SPQuery","variables","filterString","postIds","eventQuery","eventSearch","moreResults","data","searchPosts","window","innerHeight","scrollY","document","body","offsetHeight","triggerWhenScroll","addEventListener","postChangeConditions","reducer","queryTitles","i","title","reducerTitles","includes","postsSearched","initialPosts","length","eventKeys","postToShow","post","keyWord","description","toLowerCase","skill","skillNames","postsArray","filter","postsToShow","stretchLayout","pallette","colorPallette","layoutBtnClass","layoutButtonGrid","layoutButtonStretch","layoutClass","resultsContentGrid","resultsContentStretch","eventsList","name","color","iconB","iconW","iconC","eventsHTML","e","eventSelected","borderColor","backgroundColor","eventImage","eventText","event","eventsContainerClass","ECActive","showLoading","opacity","titlesString","join","resultsContainer","formContainerExpand","formExpandIcon","secondaryTitle","eventsContainer","layoutWrapper","layoutContainer","layoutBox","position","height","getInitialProps","context","postsQuery","catch","err","mapStateToProps","state","mapDispatchToProps","dispatch"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react'\r\nimport { connect } from 'react-redux'\r\nimport resStyle from '../../styles/pages/results.module.css'\r\nimport Post from '../../components/post/Post'\r\nimport { useQuery } from '@apollo/react-hooks'\r\nimport { SEARCH_POSTS } from '../../src/schemas/queries'\r\nimport { addPosts } from '../../redux/reducers/posts'\r\nimport Link from 'next/link'\r\nimport Loading from '../../components/Loading'\r\nimport { palletteGenerator } from '../../src/functions/functions'\r\nimport { toggleStretchLayout } from '../../redux/reducers/stretchLayout'\r\nimport { setEventSearch } from '../../redux/reducers/eventSearch'\r\nimport {bindActionCreators} from 'redux'\r\nimport {withRouter} from 'next/router'\r\nimport {apolloClient} from '../../lib/apollo'\r\nimport Layout from '../../components/Layout'\r\nimport Head from 'next/head'\r\n\r\nconst Results = withRouter((props) => {\r\n    console.log(props)\r\n    const currentIds = props.posts ? props.posts.map(p => p._id) : []\r\n    const [scrollAtBottom, setScrollAtBottom] = useState(false)\r\n    const decodedSearch = decodeURIComponent(props.router.query.searchQuery) === 'all' ? '' : decodeURIComponent(props.router.query.searchQuery)\r\n    const SPQuery = useQuery(SEARCH_POSTS, {\r\n        variables: {\r\n            filterString: decodedSearch,\r\n            postIds: currentIds,\r\n            eventQuery: props.eventSearch,\r\n        }\r\n    })\r\n    const moreResults = () => {\r\n        if (SPQuery.data && SPQuery.data.searchPosts === null) {\r\n            return false\r\n        }\r\n        return true\r\n    }\r\n    if (typeof window !== 'undefined') {\r\n        if ((window.innerHeight + window.scrollY) > (document.body.offsetHeight - 100) && !scrollAtBottom) {\r\n            setScrollAtBottom(true)\r\n        }\r\n        if ((window.innerHeight + window.scrollY) <= (document.body.offsetHeight - 100) && scrollAtBottom) {\r\n            setScrollAtBottom(false)\r\n        }\r\n        const triggerWhenScroll = () => {\r\n            if ((window.innerHeight + window.scrollY) > (document.body.offsetHeight - 100) && !scrollAtBottom) {\r\n                setScrollAtBottom(true)\r\n            }\r\n            if ((window.innerHeight + window.scrollY) <= (document.body.offsetHeight - 100) && scrollAtBottom) {\r\n                setScrollAtBottom(false)\r\n            }\r\n        }\r\n        window.addEventListener('scroll', triggerWhenScroll, false)\r\n    }\r\n\r\n    const postChangeConditions = (query, reducer) => {\r\n        if (!scrollAtBottom) return false\r\n        if (!query) return false\r\n        if (!query.searchPosts) return false\r\n        if (!reducer) {\r\n            return true\r\n        }\r\n        const queryTitles = query.searchPosts.map(i => i.title)\r\n        const reducerTitles = reducer.map(i => i.title)\r\n        for (const title of queryTitles) {\r\n            if (!reducerTitles.includes(title)) {\r\n                return true\r\n            }\r\n        }\r\n        return false\r\n    }\r\n    const postsSearched = postChangeConditions(SPQuery.data, props.posts) ?\r\n        SPQuery.data.searchPosts : null\r\n    useEffect(() => {\r\n        if (props.initialPosts.length && !props.posts) {\r\n            props.addPosts(props.initialPosts)\r\n        }\r\n        if (postsSearched && !props.posts) {\r\n            props.addPosts(SPQuery.data.searchPosts)\r\n            setScrollAtBottom(false)\r\n        }\r\n        if (postsSearched && props.posts) {\r\n            if (postsSearched.length > 0) {\r\n                if (!props.posts.map(p => p._id).includes(postsSearched[0]._id)){\r\n                    props.addPosts(SPQuery.data.searchPosts)\r\n                    setScrollAtBottom(false)\r\n                }\r\n            }\r\n        }\r\n    }, [SPQuery, props.addPosts, props, postsSearched])\r\n    // if (!props.posts) {\r\n    //     return (\r\n    //         <div>\r\n    //             <div style={{height: '5vh'}}/>\r\n    //             <Loading />\r\n    //         </div>\r\n    //     )\r\n    // }\r\n    const eventQuery = props.eventSearch\r\n    const eventKeys = () => {\r\n        if (eventQuery === 'COVID-19') {\r\n            return ['covid', 'coronavirus', 'outbreak', 'virus', 'emergency response']\r\n        }\r\n        if (eventQuery === '2020 Election') {\r\n            return ['election', 'democrat', 'republican', 'vote']\r\n        }\r\n        return null\r\n    }\r\n    const postToShow = (post) => {\r\n        if (eventKeys()) {\r\n            for (const keyWord of eventKeys()) {\r\n                if (post.description.toLowerCase().includes(keyWord) || post.title.toLowerCase().includes(keyWord)) {\r\n                    if (post.title.toLowerCase().includes(decodedSearch.toLowerCase())) return true\r\n                }\r\n            }\r\n            return false\r\n        }\r\n        if (post.title.toLowerCase().includes(decodedSearch.toLowerCase())) return true\r\n        for (const skill of post.skillNames) {\r\n            if (decodedSearch.includes(skill)) return true\r\n        }\r\n        return false\r\n    }\r\n    const postsArray = props.posts ? props.posts.filter(p => postToShow(p)) : []\r\n    const postsToShow = postsArray ?  postsArray.map(p => <Post stretch={props.stretchLayout} key={`post${p._id}`} post={p} />) : []\r\n    const pallette = palletteGenerator('rgb(40,40,40)').colorPallette\r\n    const layoutBtnClass= props.stretchLayout ? resStyle.layoutButtonGrid : resStyle.layoutButtonStretch\r\n    const layoutClass = !props.stretchLayout ? resStyle.resultsContentGrid : resStyle.resultsContentStretch\r\n    \r\n    const eventsList = [\r\n        {name: 'COVID-19', color: 'rgb(237,32,40)', iconB: '/svg/events/virusB.svg', iconW: '/svg/events/virusW.svg', iconC: '/svg/events/virusC.svg'},\r\n        {name: '2020 Election', color: 'rgb(255,0,255)', iconB: '/svg/events/usaB.svg', iconW: '/svg/events/usaW.svg', iconC: '/svg/events/usaC.svg'} \r\n    ]\r\n    const eventsHTML = eventsList.map(e => e.name === props.eventSearch ? \r\n        <div className={resStyle.eventSelected} onClick={() => props.setEventSearch(null)} style={{borderColor: e.color, backgroundColor: e.color}} key={`EV${e.name}`}>\r\n            <img src={e.iconW} className={resStyle.eventImage} alt={e.name} />\r\n            <h3 className={resStyle.eventText}>{e.name}</h3>\r\n        </div>\r\n        :\r\n        <div className={resStyle.event} onClick={() => props.setEventSearch(e.name)} style={{borderColor: e.color, color: e.color}} key={`EV${e.name}`}>\r\n            <img src={e.iconC} className={resStyle.eventImage} alt={e.name} />\r\n            <h3 className={resStyle.eventText}>{e.name}</h3>\r\n        </div>\r\n    )\r\n    const eventsContainerClass = props.eventSearch ? resStyle.ECActive : null\r\n    const showLoading = moreResults() ? <Loading /> : <h3 style={{opacity: '0.8'}}>no more posts</h3>\r\n    const titlesString = postsArray.map(p => p.title).join(', ')\r\n    return (\r\n        <Layout>\r\n            <Head>\r\n                <title>Browse for projects in Unilous</title>\r\n                <meta property=\"og:title\" content=\"Browse for projects in Unilous\" key=\"title\" />\r\n                <meta property=\"og:description\" content={`Unilous projects: ${titlesString}.`} key=\"description\" />\r\n                <meta name=\"twitter:title\" content=\"Browse for projects in Unilous\" key=\"title\"/>\r\n                <meta name=\"description\" content={`Unilous projects: ${titlesString}.`} key=\"description\"/>\r\n            </Head>\r\n            <div className=\"home-wrapper\">\r\n                <div className={resStyle.resultsContainer}>\r\n                    <Link href=\"/PostFormPage\" >\r\n                        <a className={`${resStyle.formContainerExpand} standard-hover neutralize-link`} title=\"add post\">\r\n                            <img className={resStyle.formExpandIcon} src=\"/svg/plusW.svg\" alt=\"team up\" />\r\n                        </a>\r\n                    </Link>\r\n                    <div className=\"navbar-height\"/>\r\n                    <h2 className={resStyle.secondaryTitle}>events</h2>\r\n                    <div className={`${resStyle.eventsContainer} ${eventsContainerClass}`}>\r\n                        {eventsHTML}\r\n                    </div>\r\n                    <div onClick={() => props.toggleStretchLayout(!props.stretchLayout)} className={resStyle.layoutWrapper}>\r\n                        <div className={resStyle.layoutContainer}>\r\n                            <div className={`layoutButton ${layoutBtnClass}`} >\r\n                                <div className={resStyle.layoutBox}/>\r\n                                <div className={resStyle.layoutBox}/>\r\n                                <div className={resStyle.layoutBox}/>\r\n                                <div className={resStyle.layoutBox}/>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                    <div />\r\n                    <div className={`resultsContent ${layoutClass}`}>\r\n                        {postsToShow}\r\n                        {/* {props.posts.map(p => <h1>{p.title}</h1>)} */}\r\n                    </div>\r\n                    <div style={{position: 'relative', height: '400px'}}>\r\n                        {showLoading}\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </Layout>\r\n    )\r\n})\r\n\r\n// const mapStateToProps = (state) => {\r\n// \treturn {\r\n//         posts: state.posts,\r\n//         search: state.search,\r\n//         stretchLayout: state.stretchLayout,\r\n//         eventSearch: state.eventSearch,\r\n// \t}\r\n// }\r\n// export default connect(\r\n//     mapStateToProps,\r\n//     { addPosts, toggleStretchLayout, setEventSearch }\r\n// )(Results)\r\n\r\nResults.getInitialProps = async (context) => {\r\n    const decodedSearch = decodeURIComponent(context.query.searchQuery) === 'all' ? '' : decodeURIComponent(context.query.searchQuery)\r\n    const postsQuery = await apolloClient.query({\r\n        query: SEARCH_POSTS,\r\n        variables: {\r\n            filterString: decodedSearch,\r\n            postIds: [],\r\n            eventQuery: null,\r\n        }\r\n    }).catch(err => console.log(err))\r\n    return {\r\n        initialPosts: postsQuery.data.searchPosts\r\n    }\r\n}\r\n\r\n\r\nconst mapStateToProps = (state) => {\r\n\treturn {\r\n        posts: state.posts,\r\n        stretchLayout: state.stretchLayout,\r\n        eventSearch: state.eventSearch,\r\n\t}\r\n}\r\nconst mapDispatchToProps = (dispatch) => {\r\n    return {\r\n        addPosts: bindActionCreators(addPosts, dispatch),\r\n        toggleStretchLayout: bindActionCreators(toggleStretchLayout, dispatch),\r\n        setEventSearch: bindActionCreators(setEventSearch, dispatch),\r\n    }\r\n}\r\n\r\nexport default connect(\r\n    mapStateToProps,\r\n    mapDispatchToProps\r\n)(Results)"]},"metadata":{},"sourceType":"module"}